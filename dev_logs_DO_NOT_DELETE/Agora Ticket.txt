1. Problem Description:

I am developing an audio call feature using AgoraRTC in a React application. After successfully joining a channel and publishing my local audio track, I encounter issues with subscribing to remote users and properly handling token renewal.

2. How to Reproduce:

1. Start the application and navigate to the audio call page.
2. Enter a channel name, click "Generate Token" and click "Join Channel".
3. Observe the logs and behavior:
- Token is successfully generated.
- Joining the channel logs show success.
- However, when a remote user publishes their audio, subscribing fails with the error: AgoraRTCException: Can't subscribe stream, not joined.
- Attempting to leave the channel results in: AgoraRTCException: Can't unpublish stream, haven't joined yet!.
- Token renewal attempts before user join lead to: AgoraRTCError INVALID_OPERATION: renewToken should not be called before user join.

3. Logs : 

// generating token for request : 

CODE CONSOLE LOG : Token received: 007eJxTYFA7s3A+F48wZ4bT/Pv7Xt8WUZSdfaw1UadN69sy7po1IQoKDJZmxsmGicYGFiZmhiapRslJJmaWaUnJ5kYpaYYWxmmWIZua03QYGRjEXzxgYmRgZGABYhCfCUwyg0kWMMnGUJJaXJJsqMJgkmxomWJiYKxrkGSaomtiYJama5GYmqKbaGhqZmxobmBqmGwEAJnbJuE=

// after join function : 

AudioCallPage.js:61 CODE CONSOLE LOG : Joined the channel: testc1 with userName: 4c19d403-0b5d-406f-8aed-a156317051c2

// remote user joined : 
AudioCallPage.js:90 CODE CONSOLE LOG : User published: d9e4fe3e-0ba8-4bf1-aa0a-3e91193ab2db

// cant hear anything.. this error is occuring.. maybe the connection is not done properly.. manual function for unpublish also not working : 

AudioCallPage.js:98 CODE CONSOLE ERROR : Error subscribing to user: AgoraRTCException: Can't subscribe stream, not joined
CODE CONSOLE ERROR : Error leaving the channel: AgoraRTCException: Can't unpublish stream, haven't joined yet!

// when token is about to expire, running the renew token function ... same join error : 

CODE CONSOLE LOG : Token privilege will expire soon. Fetching a new token...
AudioCallPage.js:46 CODE CONSOLE LOG : Token received: 007eJxTYGh9KrlJUPy2R9KGlfOYXB/1n3zf4TppsazaZp8QTa7KNx8UGCzNjJMNE40NLEzMDE1SjZKTTMws05KSzY1S0gwtjNMskzY3p+kwMjCEe3kzMAIhCxCD+ExgkhlMsoBJNoaS1OKSZEMVBpNkQ8sUEwNjXYMk0xRdEwOzNF2LxNQU3URDUzNjQ3MDU8NkIwA3qSec

AgoraRTCError INVALID_OPERATION: renewToken should not be called before user join
AgoraRTCException: renewToken should not be called before user join

// but still the message persists : 


AudioCallPage.js:69 CODE CONSOLE LOG : Token privilege will expire soon. Fetching a new token...
AudioCallPage.js:46 CODE CONSOLE LOG : Token received: 007eJxTYLj7xef9GiPud9/MTC2X7FN8sKRcl+NfhL2kydtJ0eX9JdMVGCzNjJMNE40NLEzMDE1SjZKTTMws05KSzY1S0gwtjNMsczY3p+kwMjC8lwxkYARCFiAG8ZnAJDOYZAGTbAwlqcUlyYYqDCbJhpYpJgbGugZJpim6JgZmaboWiakpuomGpmbGhuYGpobJRgC/XSin
AgoraRTCError INVALID_OPERATION: renewToken should not be called before user join
AgoraRTCException: renewToken should not be called before user join